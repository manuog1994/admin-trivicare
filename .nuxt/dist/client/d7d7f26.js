(window.webpackJsonp=window.webpackJsonp||[]).push([[63,39],{541:function(t,e){t.exports=function(data,t,e,o){var r=new Blob(void 0!==o?[o,data]:[data],{type:e||"application/octet-stream"});if(void 0!==window.navigator.msSaveBlob)window.navigator.msSaveBlob(r,t);else{var n=window.URL&&window.URL.createObjectURL?window.URL.createObjectURL(r):window.webkitURL.createObjectURL(r),d=document.createElement("a");d.style.display="none",d.href=n,d.setAttribute("download",t),void 0===d.download&&d.setAttribute("target","_blank"),document.body.appendChild(d),d.click(),setTimeout((function(){document.body.removeChild(d),window.URL.revokeObjectURL(n)}),200)}}},551:function(t,e,o){t.exports={}},561:function(t,e,o){"use strict";o(551)},569:function(t,e,o){t.exports={}},591:function(t,e,o){"use strict";o.r(e);o(17),o(133);var r=o(11),n=(o(51),o(0),o(18),o(19),o(13),{components:{ModalTrack:function(){return o.e(17).then(o.bind(null,646))}},data:function(){return{order:{},products:[],id:this.$route.params.id,users:[],user:{},status:""}},mounted:function(){this.getOrder()},methods:{getOrder:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$axios.get("/api/orders?filter[id]="+t.id).then((function(e){e.data.data.map((function(e){e.id==t.id&&(t.order=e,t.products=JSON.parse(e.products))}))})).catch((function(t){}));case 2:case"end":return e.stop()}}),e)})))()},discountedPrice:function(t){return t.price_base-t.price_base*t.discount/100},getState:function(t){return 1==t.status?"Recibido":2==t.status?"Preparando":3==t.status?"Enviado":4==t.status?"Entregado":"Cancelado"},getPaymentState:function(t){return"PENDIENTE"==t.paid?"Pendiente":"PROCESANDO"==t.paid?"Procesando":"PAGADO"==t.paid?"Pagado":"RECHAZADO"==t.paid?"Rechazado":"CONTRAREEMBOLSO"==t.paid?"Contra reembolso":"TRANSFERENCIA"==t.paid?"Transferencia":void 0},getUrl:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=o(541),r.next=3,e.$axios.get("/api/invoices/"+t.invoice.id,{responseType:"blob"}).then((function(e){n(e.data,t.invoice.filename)}));case 3:case"end":return r.stop()}}),r)})))()},updateStatus:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(3!=(o=t.$refs.formStatus.status.value)){e.next=6;break}t.$modal.hide("update-state"),t.$modal.show("modal-track",t.order.id),e.next=8;break;case 6:return e.next=8,t.$axios.put("/api/orders/status/"+t.order.id,{status:o}).then((function(){return window.location.reload()}));case 8:case"end":return e.stop()}}),e)})))()},updatePaid:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.$refs.formPaid.paid.value,e.next=3,t.$axios.put("/api/orders/paid/"+t.order.id,{paid:o}).then((function(){return window.location.reload()}));case 3:case"end":return e.stop()}}),e)})))()}}}),d=(o(561),o(68)),component=Object(d.a)(n,(function(){var t,e,o,r,n,d,v,l,c,_,f,m,h,C,w,x,y,P,R,k,O,E,$,S,j,N,T,D,F,L,z,A,U=this,M=U._self._c;return M("div",{staticClass:"container pt-3 pb-100"},[U._m(0),U._v(" "),M("div",[M("div",{staticClass:"row"},[M("div",{staticClass:"col-lg-4 mb-4"},[M("h4",[U._v("Datos del pedido")]),U._v(" "),M("p",[U._v("Id pedido: "),M("strong",[U._v(U._s(U.order.id))])]),U._v(" "),null!==(t=U.order)&&void 0!==t&&null!==(e=t.invoice)&&void 0!==e&&e.invoice_number?M("p",[U._v("Nº Factura: "),M("strong",[U._v(U._s(null===(o=U.order)||void 0===o||null===(r=o.invoice)||void 0===r?void 0:r.invoice_number))])]):U._e(),U._v(" "),M("p",[U._v("Fecha: "),M("strong",[U._v(U._s(U.order.order_date))])]),U._v(" "),M("p",[U._v("Estado: "),M("strong",[U._v(U._s(U.getState(U.order)))])]),U._v(" "),M("p",[U._v("Estado de pago: "),M("strong",[U._v(U._s(U.getPaymentState(U.order)))])]),U._v(" "),M("p",[U._v("Método de pago: "),M("strong",[U._v(U._s(U.order.payment_method))])]),U._v(" "),M("p",[U._v("Método de envío: "),M("strong",[U._v(U._s(U.order.shipping_method))])]),U._v(" "),"pickup-point"==(null===(n=U.order)||void 0===n?void 0:n.shipping_method)&&null!=U.order.pickup_point?M("p",[U._v("Punto de recogida: "),M("strong",[U._v(U._s(U.order.pickup_point))])]):U._e()]),U._v(" "),M("div",{staticClass:"col-lg-4 mb-4"},[M("h4",[U._v("Datos del cliente")]),U._v(" "),M("p",[U._v("Nombre: "),M("strong",[U._v(U._s("Guest"==(null===(d=U.order.user_profile)||void 0===d?void 0:d.name)?null===(v=U.order.guest)||void 0===v?void 0:v.name:null===(l=U.order.user_profile)||void 0===l?void 0:l.name)+" "+U._s("Guest"==(null===(c=U.order.user_profile)||void 0===c?void 0:c.lastname)?null===(_=U.order.guest)||void 0===_?void 0:_.lastname:null===(f=U.order.user_profile)||void 0===f?void 0:f.lastname))])]),U._v(" "),M("p",[U._v("Correo: "),M("strong",[U._v(U._s("guest@guest.com"==(null===(m=U.order.user)||void 0===m?void 0:m.email)?null===(h=U.order.guest)||void 0===h?void 0:h.email:null===(C=U.order.user)||void 0===C?void 0:C.email))])]),U._v(" "),M("p",[U._v("Teléfono: "),M("strong",[U._v(U._s(0==(null===(w=U.order.user_profile)||void 0===w?void 0:w.phone)?null===(x=U.order.guest)||void 0===x?void 0:x.phone:null===(y=U.order.user_profile)||void 0===y?void 0:y.phone))])]),U._v(" "),M("p",[U._v("DNI/NIE/NIF: "),M("strong",[U._v(U._s("00000000A"==(null===(P=U.order.user_profile)||void 0===P?void 0:P.dni)?null===(R=U.order.guest)||void 0===R?void 0:R.dni:null===(k=U.order.user_profile)||void 0===k?void 0:k.dni))])])]),U._v(" "),M("div",{staticClass:"col-lg-4 mb-4"},[M("h4",[U._v("Datos de envío")]),U._v(" "),M("p",[U._v("Dirección: "),M("strong",[U._v(U._s("Guest"==(null===(O=U.order.user_profile)||void 0===O?void 0:O.address)?null===(E=U.order.guest)||void 0===E?void 0:E.address:null===($=U.order.user_profile)||void 0===$?void 0:$.address))])]),U._v(" "),M("p",[U._v("Ciudad: "),M("strong",[U._v(U._s("Guest"==(null===(S=U.order.user_profile)||void 0===S?void 0:S.city)?null===(j=U.order.guest)||void 0===j?void 0:j.city:null===(N=U.order.user_profile)||void 0===N?void 0:N.city))])]),U._v(" "),M("p",[U._v("Provincia: "),M("strong",[U._v(U._s("Guest"==(null===(T=U.order.user_profile)||void 0===T?void 0:T.state)?null===(D=U.order.guest)||void 0===D?void 0:D.state:null===(F=U.order.user_profile)||void 0===F?void 0:F.state))])]),U._v(" "),M("p",[U._v("Código postal: "),M("strong",[U._v(U._s(0==(null===(L=U.order.user_profile)||void 0===L?void 0:L.zipcode)?null===(z=U.order.guest)||void 0===z?void 0:z.zipcode:null===(A=U.order.user_profile)||void 0===A?void 0:A.zipcode))])])])])]),U._v(" "),M("div",[M("table",{staticClass:"table"},[U._m(1),U._v(" "),M("tbody",U._l(this.products,(function(t){return M("tr",{key:t.id},[M("td",[M("strong",[U._v(U._s(t.name))])]),U._v(" "),M("td",[U._v(U._s(t.cartQuantity))]),U._v(" "),M("td",[t.discount<0?M("span",[U._v("\n                            "+U._s((1.21*t.price_base).toFixed(2))+" €\n                        ")]):M("span",[U._v("\n                            "+U._s((1.21*U.discountedPrice(t)).toFixed(2))+" €\n                        ")])]),U._v(" "),M("td",[U._v(U._s((t.price_base*t.cartQuantity*1.21).toFixed(2))+" €")])])})),0)])]),U._v(" "),M("div",[M("div",{staticClass:"d-flex justify-content-start"},[M("div",{staticClass:"mt-2"},[M("h4",[U._v("Nota del pedido: "),M("strong",[U._v(U._s(U.order.note))])]),U._v(" "),M("h4",{staticClass:"mt-2"},[U._v("Factura en papel: "),M("strong",[U._v(U._s(1==U.order.invoice_paper?"Si":"No"))])])])]),U._v(" "),M("div",{staticClass:"d-flex justify-content-end mt-4"},[M("div",{staticClass:"d-flex flex-column"},[M("div",{staticClass:"d-flex justify-content-between mb-2"},[M("div",{staticClass:"me-2 fw-bold"},[U._v("Subtotal:")]),U._v(" "),M("div",[U._v(U._s((1.21*U.order.total).toFixed(2))+" €")])]),U._v(" "),U.order.coupon?M("div",{staticClass:"d-flex justify-content-between mb-2"},[M("div",{staticClass:"me-2 fw-bold"},[U._v("Cupón:")]),U._v(" "),M("div",[U._v(U._s(U.order.coupon)+" ")])]):U._e(),U._v(" "),M("div",{staticClass:"d-flex justify-content-evenly mb-2"},[U._m(2),U._v(" "),0==U.order.shipping?M("div",[M("p",{staticClass:"text-danger ms-4"},[U._v("Gratis")])]):M("div",[M("p",{staticClass:"text-danger ms-4"},[U._v(U._s(U.order.shipping)+" €")])])]),U._v(" "),M("div",{staticClass:"d-flex justify-content-between mt-2"},[M("div",{staticClass:"me-2 fs-4 fw-bold"},[U._v("Total:")]),U._v(" "),0==U.order.shipping?M("div",{staticStyle:{"font-size":"20px"}},[U._v(U._s((1.21*U.order.total).toFixed(2))+" €")]):M("div",{staticStyle:{"font-size":"20px"}},[U._v(U._s((1.21*parseFloat(U.order.total)+parseFloat(U.order.shipping)).toFixed(2))+" €")])])])])]),U._v(" "),M("div",{staticClass:"d-flex justify-content-around mt-5 fixed-bottom bg-trivi-purple p-4"},[M("button",{staticClass:"btn bg-trivi-blue text-white",on:{click:function(t){return U.$modal.show("update-state",U.order)}}},[M("i",{staticClass:"fa fa-truck icon-nav-order"})]),U._v(" "),M("button",{staticClass:"btn bg-trivi-orange text-white",on:{click:function(t){return U.$modal.show("update-pay",U.order)}}},[M("i",{staticClass:"fa fa-credit-card icon-nav-order"})]),U._v(" "),M("button",{staticClass:"btn bg-trivi-green text-white",class:{disabled:!U.order.email_sent},on:{click:function(t){return t.preventDefault(),U.getUrl(U.order)}}},[M("i",{staticClass:"fa fa-download icon-nav-order"})]),U._v(" "),M("button",{staticClass:"btn bg-trivi-red text-white",on:{click:function(t){return U.$router.push({path:"/orders"})}}},[M("i",{staticClass:"fa fa-level-up icon-nav-order"})])]),U._v(" "),M("modal",{attrs:{name:"update-state",width:"800px",height:"auto"}},[M("div",{staticClass:"p-5"},[M("div",[M("h2",[U._v("Cambiar estado del pedido")])]),U._v(" "),M("form",{ref:"formStatus",on:{submit:function(t){return t.preventDefault(),U.updateStatus.apply(null,arguments)}}},[M("div",[M("label",{attrs:{for:"status"}},[U._v("Estado")]),U._v(" "),M("select",{staticClass:"form-select",attrs:{name:"status",id:"status"},domProps:{value:U.order.status}},[M("option",{attrs:{value:"1"}},[U._v("Recibido")]),U._v(" "),M("option",{attrs:{value:"2"}},[U._v("Preparando")]),U._v(" "),M("option",{attrs:{value:"3"}},[U._v("Enviado")]),U._v(" "),M("option",{attrs:{value:"4"}},[U._v("Entregado")]),U._v(" "),M("option",{attrs:{value:"4"}},[U._v("Cancelado")])])]),U._v(" "),M("div",{staticClass:"d-flex justify-content-end mt-3"},[M("button",{staticClass:"btn btn-primary",attrs:{type:"submit"}},[U._v("Enviar")])])])])]),U._v(" "),M("ModalTrack"),U._v(" "),M("modal",{attrs:{name:"update-pay",width:"800px",height:"auto"}},[M("div",{staticClass:"p-5"},[M("div",[M("h2",[U._v("Cambiar estado de pago")])]),U._v(" "),M("form",{ref:"formPaid",on:{submit:function(t){return t.preventDefault(),U.updatePaid.apply(null,arguments)}}},[M("div",[M("label",{attrs:{for:"pay"}},[U._v("Estado")]),U._v(" "),M("select",{staticClass:"form-select",attrs:{name:"paid",id:"paid"},domProps:{value:U.order.paid}},[M("option",{attrs:{value:"Selecciona un estado",disabled:"",selected:""}},[U._v("Seleccione un estado")]),U._v(" "),M("option",{attrs:{value:"1"}},[U._v("Pendiente")]),U._v(" "),M("option",{attrs:{value:"2"}},[U._v("Procesando")]),U._v(" "),M("option",{attrs:{value:"3"}},[U._v("Pagado")]),U._v(" "),M("option",{attrs:{value:"4"}},[U._v("Rechazado")])])]),U._v(" "),M("div",{staticClass:"d-flex justify-content-end mt-3"},[M("button",{staticClass:"btn btn-primary",attrs:{type:"submit"}},[U._v("Enviar")])])])])])],1)}),[function(){var t=this._self._c;return t("div",{staticClass:"mb-5"},[t("div",[t("h2",[this._v("Detalle del pedido")])])])},function(){var t=this,e=t._self._c;return e("thead",[e("tr",[e("th",{attrs:{scope:"col"}},[t._v("Producto")]),t._v(" "),e("th",{attrs:{scope:"col"}},[t._v("Cantidad")]),t._v(" "),e("th",{attrs:{scope:"col"}},[t._v("Precio")]),t._v(" "),e("th",{attrs:{scope:"col"}},[t._v("Total")])])])},function(){var t=this._self._c;return t("div",{staticClass:"me-2"},[t("p",{staticClass:"fw-bold"},[this._v("Gastos de envío:")])])}],!1,null,null,null);e.default=component.exports},598:function(t,e,o){"use strict";o(569)},625:function(t,e,o){"use strict";o.r(e);o(0),o(18),o(19),o(42);var r={components:{OrdersCom:function(){return Promise.resolve().then(o.bind(null,591))}},data:function(){return{searchChildren:"",unauthorized:""}},mounted:function(){var t=this;this.$nextTick((function(){t.$nuxt.$loading.start(),setTimeout((function(){t.$nuxt.$loading.finish()}),2e3)})),this.$axios.onError((function(e){401===e.response.status&&(t.unauthorized=!0)}))},watch:{unauthorized:function(){1==this.unauthorized&&this.$auth.logout()}},methods:{closeMenus:function(){this.searchOpacity(!1),this.$root.$emit("closeMenu",this.closeMenu)},searchOpacity:function(t){1==t?document.getElementById("post-nav").classList.add("search-screen"):document.getElementById("post-nav").classList.remove("search-screen")}},head:function(){return{titleTemplate:"Mis Pedidos | TriviCare Natural Cosmetics"}}},n=(o(598),o(68)),component=Object(n.a)(r,(function(){var t=this._self._c;return t("client-only",[t("div",{staticClass:"shop-page-wrapper"},[t("OrdersCom")],1)])}),[],!1,null,"5a74135c",null);e.default=component.exports;installComponents(component,{OrdersCom:o(591).default})}}]);