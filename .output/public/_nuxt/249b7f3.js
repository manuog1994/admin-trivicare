(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{654:function(t,e,o){"use strict";o.r(e);o(18);var n=o(11),r=(o(51),o(0),o(19),o(20),o(15),o(554)),c=o.n(r),d={auth:!0,components:{EditProduct:function(){return o.e(19).then(o.bind(null,650))},CreateProduct:function(){return o.e(18).then(o.bind(null,649))}},data:function(){return{products:[],status:"",productId:"",yesterday:[],today:[],index:[],store:[],productsVisitors:[],cart:[],checkout:[],product:[],edit:!1,newProduct:!1,page:1,perPage:10}},beforeMount:function(){var t=this;this.$root.$on("closeAdd",(function(data){t.newProduct=data})),this.$root.$on("closeEdit",(function(data){t.edit=data}))},mounted:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getProducts();case 2:case"end":return e.stop()}}),e)})))()},computed:{paginatedItems:function(){var t=(this.page-1)*this.perPage;return this.products.slice(t,t+this.perPage)}},methods:{getProducts:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$axios.get("/api/products").then((function(e){t.products=e.data.data,t.$root.$emit("loading",!1)}));case 2:case"end":return e.stop()}}),e)})))()},onClick:function(t){this.$root.$emit("loading",!0),this.edit=!0,this.product=t},onClickNew:function(){this.$root.$emit("loading",!0),this.newProduct=!0},updateStatus:function(t){var e=this;return Object(n.a)(regeneratorRuntime.mark((function o(){return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if("Publicado"!==t.status){o.next=5;break}return o.next=3,e.$axios.put("/api/products/status/"+t.id,{status:"Borrador"}).then((function(t){e.$notify({title:"Estado del producto actualizado"})}));case 3:o.next=7;break;case 5:return o.next=7,e.$axios.put("/api/products/status/"+t.id,{status:"Publicado"}).then((function(t){e.$notify({title:"Estado del producto actualizado"})}));case 7:window.location.reload(!0);case 8:case"end":return o.stop()}}),o)})))()},destroy:function(t){var e=this;c.a.fire({title:"¿Estás seguro?",text:"¡No podrás revertir esto!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"¡Sí, bórralo!"}).then((function(o){o.isConfirmed&&e.$axios.delete("/api/products/"+t).then((function(t){e.$notify({title:"Producto eliminado"}),window.location.reload(!0)}))}))},myCallback:function(t){this.page=t}}},l=o(68),component=Object(l.a)(d,(function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"main"},[0==t.edit&&0==t.newProduct?e("div",{staticClass:"d-flex justify-content-end mb-4"},[e("button",{staticClass:"btn btn-primary",on:{click:t.onClickNew}},[e("i",{staticClass:"fa fa-plus"})])]):t._e(),t._v(" "),0==t.edit&&0==t.newProduct?e("table",{staticClass:"table"},[t._m(0),t._v(" "),t.products.length>0?e("tbody",t._l(t.products,(function(o){return e("tr",{key:o.id},[e("th",{attrs:{scope:"row"}},[t._v(t._s(o.id))]),t._v(" "),e("td",[e("n-link",{attrs:{to:"/product/".concat(o.slug)}},[t._v(t._s(o.name))])],1),t._v(" "),e("td",[t._v(t._s(o.price)+" €")]),t._v(" "),o.discount>0?e("td",[t._v(t._s(o.discount)+" %")]):e("td",[t._v("-")]),t._v(" "),o.sold>0?e("td",[t._v(t._s(o.sold))]):e("td",[t._v("-")]),t._v(" "),o.stock>0?e("td",[t._v(t._s(o.stock))]):e("td",[t._v("-")]),t._v(" "),e("td",[e("select",{staticClass:"form-select",attrs:{name:"status"},on:{change:function(e){return t.updateStatus(o)}}},[e("option",[t._v(t._s(o.status))]),t._v(" "),"Borrador"===o.status?e("option",{attrs:{value:"Publicado"}},[t._v("Publicado")]):e("option",{attrs:{value:"Borrador"}},[t._v("Borrador")])])]),t._v(" "),e("td",[e("div",[e("button",{staticClass:"btn btn-warning btn-sm text-white",attrs:{title:"Editar producto"},on:{click:function(e){return t.onClick(o)}}},[e("i",{staticClass:"fa fa-edit"})]),t._v(" "),e("button",{staticClass:"btn btn-danger btn-sm text-white",attrs:{title:"Eliminar producto"},on:{click:function(e){return t.destroy(o.id)}}},[e("i",{staticClass:"fa fa-trash"})])])])])})),0):e("tbody",[t._m(1)])]):t._e(),t._v(" "),0==t.edit&&0==t.newProduct?e("div",{staticClass:"d-flex justify-content-center mt-2"},[e("pagination",{attrs:{records:t.products.length,perPage:t.perPage},on:{paginate:t.myCallback},model:{value:t.page,callback:function(e){t.page=e},expression:"page"}})],1):t._e(),t._v(" "),1==t.edit?e("EditProduct",{attrs:{product:t.product}}):t._e(),t._v(" "),1==t.newProduct?e("CreateProduct"):t._e()],1)])}),[function(){var t=this,e=t._self._c;return e("thead",[e("tr",[e("th",{attrs:{scope:"col"}},[t._v("#")]),t._v(" "),e("th",{attrs:{scope:"col"}},[t._v("Producto(s)")]),t._v(" "),e("th",{attrs:{scope:"col"}},[t._v("Precio")]),t._v(" "),e("th",{attrs:{scope:"col"}},[t._v("Descuento")]),t._v(" "),e("th",{attrs:{scope:"col"}},[t._v("Vendido(s)")]),t._v(" "),e("th",{attrs:{scope:"col"}},[t._v("Stock")]),t._v(" "),e("th",{attrs:{scope:"col"}},[t._v("Estado")]),t._v(" "),e("th",{attrs:{scope:"col"}},[t._v("Acciones")])])])},function(){var t=this._self._c;return t("tr",[t("td",{attrs:{colspan:"8"}},[this._v("No hay productos.")])])}],!1,null,null,null);e.default=component.exports}}]);