(window.webpackJsonp=window.webpackJsonp||[]).push([[65,40],{539:function(t,e){t.exports=function(data,t,e,o){var r=new Blob(void 0!==o?[o,data]:[data],{type:e||"application/octet-stream"});if(void 0!==window.navigator.msSaveBlob)window.navigator.msSaveBlob(r,t);else{var n=window.URL&&window.URL.createObjectURL?window.URL.createObjectURL(r):window.webkitURL.createObjectURL(r),d=document.createElement("a");d.style.display="none",d.href=n,d.setAttribute("download",t),void 0===d.download&&d.setAttribute("target","_blank"),document.body.appendChild(d),d.click(),setTimeout((function(){document.body.removeChild(d),window.URL.revokeObjectURL(n)}),200)}}},549:function(t,e,o){t.exports={}},559:function(t,e,o){"use strict";o(549)},569:function(t,e,o){t.exports={}},590:function(t,e,o){"use strict";o.r(e);o(18),o(133);var r=o(11),n=(o(51),o(0),o(19),o(20),o(13),o(5),{components:{ModalTrack:function(){return o.e(17).then(o.bind(null,647))}},data:function(){return{order:{},products:[],id:this.$route.params.id,users:[],user:{},status:""}},mounted:function(){this.getOrder()},methods:{getOrder:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.$root.$emit("loading",!0),e.next=3,t.$axios.get("/api/orders?filter[id]="+t.id).then((function(e){t.$root.$emit("loading",!1),e.data.data.map((function(e){e.id==t.id&&(t.order=e,t.products=JSON.parse(e.products))}))})).catch((function(e){t.$root.$emit("loading",!1)}));case 3:case"end":return e.stop()}}),e)})))()},discountedPrice:function(t){return t.price_base-t.price_base*t.discount/100},getState:function(t){return 1==t.status?"Recibido":2==t.status?"Preparando":3==t.status?"Enviado":4==t.status?"Entregado":"Cancelado"},getPaymentState:function(t){return"PENDIENTE"==t.paid?"Pendiente":"PROCESANDO"==t.paid?"Procesando":"PAGADO"==t.paid?"Pagado":"RECHAZADO"==t.paid?"Rechazado":"CONTRAREEMBOLSO"==t.paid?"Contra reembolso":"TRANSFERENCIA"==t.paid?"Transferencia":void 0},getUrl:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return e.$root.$emit("loading",!0),n=o(539),r.next=4,e.$axios.get("/api/invoices/"+t.invoice.id,{responseType:"blob"}).then((function(o){n(o.data,t.invoice.filename),e.$root.$emit("loading",!1)}));case 4:case"end":return r.stop()}}),r)})))()},updateStatus:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.$root.$emit("loading",!0),3!=(o=t.$refs.formStatus.status.value)){e.next=8;break}t.$modal.hide("update-state"),t.$modal.show("modal-track",t.order.id),t.$root.$emit("loading",!1),e.next=11;break;case 8:return e.next=10,t.$axios.put("/api/orders/status/"+t.order.id,{status:o}).then((function(){return window.location.reload()}));case 10:t.$root.$emit("loading",!1);case 11:case"end":return e.stop()}}),e)})))()},updatePaid:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.$root.$emit("loading",!0),o=t.$refs.formPaid.paid.value,e.next=4,t.$axios.put("/api/orders/paid/"+t.order.id,{paid:o}).then((function(){window.location.reload(),t.$root.$emit("loading",!1)}));case 4:case"end":return e.stop()}}),e)})))()}}}),d=(o(559),o(68)),component=Object(d.a)(n,(function(){var t,e,o,r,n,d,l,v,c,_,f,m,h,C,w,x,y,$,P,R,k,O,E,S,j,D,N,F,A,L,T,U,G,z=this,B=z._self._c;return B("div",{staticClass:"container pt-3 pb-100"},[z._m(0),z._v(" "),B("div",[B("div",{staticClass:"row"},[B("div",{staticClass:"col-lg-4 mb-4"},[B("h4",[z._v("Datos del pedido")]),z._v(" "),B("p",[z._v("Id pedido: "),B("strong",[z._v(z._s(z.order.id))])]),z._v(" "),null!==(t=z.order)&&void 0!==t&&null!==(e=t.invoice)&&void 0!==e&&e.invoice_number?B("p",[z._v("Nº Factura: "),B("strong",[z._v(z._s(null===(o=z.order)||void 0===o||null===(r=o.invoice)||void 0===r?void 0:r.invoice_number))])]):z._e(),z._v(" "),B("p",[z._v("Fecha: "),B("strong",[z._v(z._s(z.order.order_date))])]),z._v(" "),B("p",[z._v("Estado: "),B("strong",[z._v(z._s(z.getState(z.order)))])]),z._v(" "),B("p",[z._v("Estado de pago: "),B("strong",[z._v(z._s(z.getPaymentState(z.order)))])]),z._v(" "),B("p",[z._v("Método de pago: "),B("strong",[z._v(z._s(z.order.payment_method))])]),z._v(" "),B("p",[z._v("Método de envío: "),B("strong",[z._v(z._s(z.order.shipping_method))])]),z._v(" "),"pickup-point"==(null===(n=z.order)||void 0===n?void 0:n.shipping_method)&&null!=z.order.pickup_point?B("p",[z._v("Punto de recogida: "),B("strong",[z._v(z._s(z.order.pickup_point))])]):z._e()]),z._v(" "),B("div",{staticClass:"col-lg-4 mb-4"},[B("h4",[z._v("Datos del cliente")]),z._v(" "),B("p",[z._v("Nombre: "),B("strong",[z._v(z._s("Guest"==(null===(d=z.order.user_profile)||void 0===d?void 0:d.name)?null===(l=z.order.guest)||void 0===l?void 0:l.name:null===(v=z.order.user_profile)||void 0===v?void 0:v.name)+" "+z._s("Guest"==(null===(c=z.order.user_profile)||void 0===c?void 0:c.lastname)?null===(_=z.order.guest)||void 0===_?void 0:_.lastname:null===(f=z.order.user_profile)||void 0===f?void 0:f.lastname))])]),z._v(" "),B("p",[z._v("Correo: "),B("strong",[z._v(z._s("guest@guest.com"==(null===(m=z.order.user)||void 0===m?void 0:m.email)?null===(h=z.order.guest)||void 0===h?void 0:h.email:null===(C=z.order.user)||void 0===C?void 0:C.email))])]),z._v(" "),B("p",[z._v("Teléfono: "),B("strong",[z._v(z._s(0==(null===(w=z.order.user_profile)||void 0===w?void 0:w.phone)?null===(x=z.order.guest)||void 0===x?void 0:x.phone:null===(y=z.order.user_profile)||void 0===y?void 0:y.phone))])]),z._v(" "),B("p",[z._v("DNI/NIE/NIF: "),B("strong",[z._v(z._s("00000000A"==(null===($=z.order.user_profile)||void 0===$?void 0:$.dni)?null===(P=z.order.guest)||void 0===P?void 0:P.dni:null===(R=z.order.user_profile)||void 0===R?void 0:R.dni))])])]),z._v(" "),B("div",{staticClass:"col-lg-4 mb-4"},[B("h4",[z._v("Datos de envío")]),z._v(" "),B("p",[z._v("Dirección: "),B("strong",[z._v(z._s("Guest"==(null===(k=z.order.user_profile)||void 0===k?void 0:k.address)?null===(O=z.order.guest)||void 0===O?void 0:O.address:null===(E=z.order.user_profile)||void 0===E?void 0:E.address))])]),z._v(" "),B("p",[z._v("Ciudad: "),B("strong",[z._v(z._s("Guest"==(null===(S=z.order.user_profile)||void 0===S?void 0:S.city)?null===(j=z.order.guest)||void 0===j?void 0:j.city:null===(D=z.order.user_profile)||void 0===D?void 0:D.city))])]),z._v(" "),B("p",[z._v("Provincia: "),B("strong",[z._v(z._s("Guest"==(null===(N=z.order.user_profile)||void 0===N?void 0:N.state)?null===(F=z.order.guest)||void 0===F?void 0:F.state:null===(A=z.order.user_profile)||void 0===A?void 0:A.state))])]),z._v(" "),B("p",[z._v("Código postal: "),B("strong",[z._v(z._s(0==(null===(L=z.order.user_profile)||void 0===L?void 0:L.zipcode)?null===(T=z.order.guest)||void 0===T?void 0:T.zipcode:null===(U=z.order.user_profile)||void 0===U?void 0:U.zipcode))])])])])]),z._v(" "),B("div",[B("table",{staticClass:"table"},[z._m(1),z._v(" "),B("tbody",z._l(this.products,(function(t){return B("tr",{key:t.id},[B("td",[B("strong",[z._v(z._s(t.name))])]),z._v(" "),B("td",[z._v(z._s(t.cartQuantity))]),z._v(" "),B("td",[t.discount<0?B("span",[z._v("\n                            "+z._s((1.21*t.price_base).toFixed(2))+" €\n                        ")]):B("span",[z._v("\n                            "+z._s((1.21*z.discountedPrice(t)).toFixed(2))+" €\n                        ")])]),z._v(" "),B("td",[z._v(z._s((t.price_base*t.cartQuantity*1.21).toFixed(2))+" €")])])})),0)])]),z._v(" "),B("div",{staticClass:"pb-100 mb-5"},[B("div",{staticClass:"d-flex justify-content-start"},[B("div",{staticClass:"mt-2"},[B("h4",[z._v("Nota del pedido: "),B("strong",[z._v(z._s(z.order.note))])]),z._v(" "),B("h4",{staticClass:"mt-2"},[z._v("Factura en papel: "),B("strong",[z._v(z._s(1==z.order.invoice_paper?"Si":"No"))])])])]),z._v(" "),B("div",{staticClass:"d-flex justify-content-end mt-4"},[B("div",{staticClass:"d-flex flex-column"},[B("div",{staticClass:"d-flex justify-content-between mb-2"},[B("div",{staticClass:"me-2 fw-bold"},[z._v("Subtotal:")]),z._v(" "),B("div",[z._v(z._s((1.21*z.order.total).toFixed(2))+" €")])]),z._v(" "),z.order.coupon?B("div",{staticClass:"d-flex justify-content-between mb-2"},[B("div",{staticClass:"me-2 fw-bold"},[z._v("Cupón:")]),z._v(" "),B("div",[z._v(z._s(z.order.coupon)+" ")])]):z._e(),z._v(" "),B("div",{staticClass:"d-flex justify-content-evenly mb-2"},[z._m(2),z._v(" "),0==z.order.shipping?B("div",[B("p",{staticClass:"text-danger ms-4"},[z._v("Gratis")])]):B("div",[B("p",{staticClass:"text-danger ms-4"},[z._v(z._s(z.order.shipping)+" €")])])]),z._v(" "),B("div",{staticClass:"d-flex justify-content-between mt-2"},[B("div",{staticClass:"me-2 fs-4 fw-bold"},[z._v("Total:")]),z._v(" "),0==z.order.shipping?B("div",{staticStyle:{"font-size":"20px"}},[z._v(z._s((1.21*z.order.total).toFixed(2))+" €")]):B("div",{staticStyle:{"font-size":"20px"}},[z._v(z._s((1.21*parseFloat(z.order.total)+parseFloat(z.order.shipping)).toFixed(2))+" €")])])])])]),z._v(" "),B("div",{staticClass:"d-flex justify-content-around mt-5 fixed-bottom bg-trivi-purple p-4"},[B("button",{staticClass:"btn bg-trivi-blue text-white",on:{click:function(t){return z.$modal.show("update-state",z.order)}}},[B("i",{staticClass:"fa fa-truck icon-nav-order"})]),z._v(" "),B("button",{staticClass:"btn bg-trivi-orange text-white",on:{click:function(t){return z.$modal.show("update-pay",z.order)}}},[B("i",{staticClass:"fa fa-credit-card icon-nav-order"})]),z._v(" "),B("button",{staticClass:"btn bg-trivi-green text-white",class:{disabled:null===(G=z.order.invoice)||void 0===G||!G.filename},on:{click:function(t){return t.preventDefault(),z.getUrl(z.order)}}},[B("i",{staticClass:"fa fa-download icon-nav-order"})]),z._v(" "),B("button",{staticClass:"btn bg-trivi-red text-white",on:{click:function(t){return z.$router.push({path:"/orders"})}}},[B("i",{staticClass:"fa fa-level-up icon-nav-order"})])]),z._v(" "),B("modal",{attrs:{name:"update-state",width:"800px",height:"auto"}},[B("div",{staticClass:"p-5"},[B("div",[B("h2",[z._v("Cambiar estado del pedido")])]),z._v(" "),B("form",{ref:"formStatus",on:{submit:function(t){return t.preventDefault(),z.updateStatus.apply(null,arguments)}}},[B("div",[B("label",{attrs:{for:"status"}},[z._v("Estado")]),z._v(" "),B("select",{staticClass:"form-select",attrs:{name:"status",id:"status"},domProps:{value:z.order.status}},[B("option",{attrs:{value:"1"}},[z._v("Recibido")]),z._v(" "),B("option",{attrs:{value:"2"}},[z._v("Preparando")]),z._v(" "),B("option",{attrs:{value:"3"}},[z._v("Enviado")]),z._v(" "),B("option",{attrs:{value:"4"}},[z._v("Entregado")]),z._v(" "),B("option",{attrs:{value:"4"}},[z._v("Cancelado")])])]),z._v(" "),B("div",{staticClass:"d-flex justify-content-end mt-3"},[B("button",{staticClass:"btn btn-primary",attrs:{type:"submit"}},[z._v("Enviar")])])])])]),z._v(" "),B("ModalTrack"),z._v(" "),B("modal",{attrs:{name:"update-pay",width:"800px",height:"auto"}},[B("div",{staticClass:"p-5"},[B("div",[B("h2",[z._v("Cambiar estado de pago")])]),z._v(" "),B("form",{ref:"formPaid",on:{submit:function(t){return t.preventDefault(),z.updatePaid.apply(null,arguments)}}},[B("div",[B("label",{attrs:{for:"pay"}},[z._v("Estado")]),z._v(" "),B("select",{staticClass:"form-select",attrs:{name:"paid",id:"paid"},domProps:{value:z.order.paid}},[B("option",{attrs:{value:"Selecciona un estado",disabled:"",selected:""}},[z._v("Seleccione un estado")]),z._v(" "),B("option",{attrs:{value:"1"}},[z._v("Pendiente")]),z._v(" "),B("option",{attrs:{value:"2"}},[z._v("Procesando")]),z._v(" "),B("option",{attrs:{value:"3"}},[z._v("Pagado")]),z._v(" "),B("option",{attrs:{value:"4"}},[z._v("Rechazado")])])]),z._v(" "),B("div",{staticClass:"d-flex justify-content-end mt-3"},[B("button",{staticClass:"btn btn-primary",attrs:{type:"submit"}},[z._v("Enviar")])])])])])],1)}),[function(){var t=this._self._c;return t("div",{staticClass:"mb-5"},[t("div",[t("h2",[this._v("Detalle del pedido")])])])},function(){var t=this,e=t._self._c;return e("thead",[e("tr",[e("th",{attrs:{scope:"col"}},[t._v("Producto")]),t._v(" "),e("th",{attrs:{scope:"col"}},[t._v("Cantidad")]),t._v(" "),e("th",{attrs:{scope:"col"}},[t._v("Precio")]),t._v(" "),e("th",{attrs:{scope:"col"}},[t._v("Total")])])])},function(){var t=this._self._c;return t("div",{staticClass:"me-2"},[t("p",{staticClass:"fw-bold"},[this._v("Gastos de envío:")])])}],!1,null,null,null);e.default=component.exports},599:function(t,e,o){"use strict";o(569)},626:function(t,e,o){"use strict";o.r(e);o(0),o(19),o(20);var r={components:{OrdersCom:function(){return Promise.resolve().then(o.bind(null,590))},BigLoader:function(){return o.e(3).then(o.bind(null,644))}},data:function(){return{loading:!1}},beforeMount:function(){var t=this;this.$root.$on("loading",(function(data){t.loading=data}))},head:function(){return{titleTemplate:"Detalle del Pedido | Admin"}}},n=(o(599),o(68)),component=Object(n.a)(r,(function(){var t=this,e=t._self._c;return e("client-only",[e("div",{staticClass:"shop-page-wrapper"},[e("OrdersCom"),t._v(" "),t.loading?e("BigLoader"):t._e()],1)])}),[],!1,null,"31e048e8",null);e.default=component.exports;installComponents(component,{OrdersCom:o(590).default})}}]);