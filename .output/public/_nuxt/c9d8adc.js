(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{539:function(e,t){e.exports=function(data,e,t,n){var o=new Blob(void 0!==n?[n,data]:[data],{type:t||"application/octet-stream"});if(void 0!==window.navigator.msSaveBlob)window.navigator.msSaveBlob(o,e);else{var r=window.URL&&window.URL.createObjectURL?window.URL.createObjectURL(o):window.webkitURL.createObjectURL(o),c=document.createElement("a");c.style.display="none",c.href=r,c.setAttribute("download",e),void 0===c.download&&c.setAttribute("target","_blank"),document.body.appendChild(c),c.click(),setTimeout((function(){document.body.removeChild(c),window.URL.revokeObjectURL(r)}),200)}}},583:function(e,t,n){"use strict";n.r(t);n(13),n(2),n(0),n(12),n(15),n(18);var o=n(11),r=(n(51),n(19),n(20),n(42),n(21),n(3),n(47),n(70),{auth:!0,data:function(){return{invoices:[],selectedInvoices:[],month:0,limit:10,day:0,year:0,years:[],page:1,perPage:10,pdfViewer:!1,id:"",newInvoice:!1}},beforeMount:function(){var e=this;this.$root.$on("closeNewInvoice",(function(data){e.newInvoice=data}))},mounted:function(){this.getInvoices()},components:{InvoiceViewer:function(){return n.e(13).then(n.bind(null,641))},NewInvoice:function(){return Promise.all([n.e(5),n.e(14)]).then(n.bind(null,642))}},computed:{paginatedItems:function(){var e=(this.page-1)*parseInt(this.limit);return this.invoices.slice(e,e+parseInt(this.limit))}},watch:{day:function(){var e=this;setTimeout((function(){e.getInvoices()}),500)},month:function(){var e=this;setTimeout((function(){e.getInvoices()}),500)},year:function(){var e=this;setTimeout((function(){e.getInvoices()}),500)},limit:function(){var e=this;setTimeout((function(){e.getInvoices()}),500)},id:function(){this.pdfViewer=!0}},methods:{getInvoices:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.$root.$emit("loading",!0),t.next=3,e.$axios.get("/api/invoice");case 3:n=t.sent,e.invoices=n.data.data,0!=e.day&&(e.invoices=e.invoices.filter((function(t){return new Date(t.created_at).getDate()==e.day}))),0!=e.month&&(e.invoices=e.invoices.filter((function(t){return new Date(t.created_at).getMonth()+1==e.month}))),0!=e.year&&(e.invoices=e.invoices.filter((function(t){return new Date(t.created_at).getFullYear()==e.year}))),e.getYears(),e.$root.$emit("loading",!1);case 10:case"end":return t.stop()}}),t)})))()},getUrl:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function o(){var r;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return r=n(539),o.next=3,t.$axios.get("/api/invoices/"+e.id,{responseType:"blob"}).then((function(t){r(t.data,e.filename)}));case 3:case"end":return o.stop()}}),o)})))()},formatDate:function(e){var t=new Date(e),n=""+(t.getMonth()+1),o=""+t.getDate(),r=t.getFullYear();return n.length<2&&(n="0"+n),o.length<2&&(o="0"+o),[o,n,r].join("-")},downloadZip:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=n(539),t.next=3,e.$axios.get("/api/multiples-invoices",{responseType:"blob",params:{selecteds:JSON.stringify(e.selectedInvoices)}}).then((function(e){o(e.data,"facturas.zip")})).catch((function(e){}));case 3:case"end":return t.stop()}}),t)})))()},selectAll:function(){var e=this;this.$refs.checkSelect.checked?this.invoices.forEach((function(t){e.selectedInvoices.push(t.id)})):this.selectedInvoices=[]},getYears:function(){var e=this;this.invoices.forEach((function(t){var n=new Date(t.created_at);e.years.includes(n.getFullYear())||e.years.push(n.getFullYear())}))},myCallback:function(e){this.page=e},changeView:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:t.id=e;case 1:case"end":return n.stop()}}),n)})))()}}}),c=n(68),component=Object(c.a)(r,(function(){var e,t,n,o,r=this,c=r._self._c;return c("div",[r.newInvoice?r._e():c("div",{staticClass:"main"},[c("div",[0==(null===(e=r.selectedInvoices)||void 0===e?void 0:e.length)?c("div",{staticClass:"d-flex justify-content-end"},[c("button",{staticClass:"btn bg-trivi-red text-white mb-2",on:{click:function(e){r.newInvoice=!0}}},[c("i",{staticClass:"fa fa-plus"})])]):r._e(),r._v(" "),(null===(t=r.selectedInvoices)||void 0===t?void 0:t.length)>0?c("div",{staticClass:"d-flex justify-content-end"},[c("button",{staticClass:"btn bg-trivi-green text-white mb-2",on:{click:r.downloadZip}},[c("i",{staticClass:"fa fa-download"}),r._v("\n                    Descargar "+r._s(null===(n=r.selectedInvoices)||void 0===n?void 0:n.length)+" facturas\n                ")])]):r._e(),r._v(" "),r._m(0)]),r._v(" "),c("div",{staticClass:"d-flex justify-content-between"},[c("div",{staticClass:"form-group"},[c("label",{attrs:{for:"limit"}},[r._v("Mostrar")]),r._v(" "),c("select",{directives:[{name:"model",rawName:"v-model",value:r.limit,expression:"limit"}],staticClass:"form-control",attrs:{id:"limit"},on:{change:function(e){var t=Array.prototype.filter.call(e.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));r.limit=e.target.multiple?t:t[0]}}},[c("option",{attrs:{value:"10"}},[r._v("10")]),r._v(" "),c("option",{attrs:{value:"20"}},[r._v("20")]),r._v(" "),c("option",{attrs:{value:"50"}},[r._v("50")]),r._v(" "),c("option",{attrs:{value:"1000"}},[r._v("Todo")])])]),r._v(" "),c("div",{staticClass:"d-flex"},[c("div",{staticClass:"form-group me-2"},[c("label",{attrs:{for:"day"}},[r._v("Día")]),r._v(" "),c("select",{directives:[{name:"model",rawName:"v-model",value:r.day,expression:"day"}],staticClass:"form-control",attrs:{id:"day"},on:{change:function(e){var t=Array.prototype.filter.call(e.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));r.day=e.target.multiple?t:t[0]}}},[c("option",{attrs:{value:"0"}},[r._v("Todos")]),r._v(" "),r._l(31,(function(e){return c("option",{key:e,domProps:{value:e}},[r._v(r._s(e))])}))],2)]),r._v(" "),c("div",{staticClass:"form-group me-2"},[c("label",{attrs:{for:"month"}},[r._v("Mes")]),r._v(" "),c("select",{directives:[{name:"model",rawName:"v-model",value:r.month,expression:"month"}],staticClass:"form-control",attrs:{id:"month"},on:{change:function(e){var t=Array.prototype.filter.call(e.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));r.month=e.target.multiple?t:t[0]}}},[c("option",{attrs:{value:"0"}},[r._v("Todos")]),r._v(" "),c("option",{attrs:{value:"1"}},[r._v("Enero")]),r._v(" "),c("option",{attrs:{value:"2"}},[r._v("Febrero")]),r._v(" "),c("option",{attrs:{value:"3"}},[r._v("Marzo")]),r._v(" "),c("option",{attrs:{value:"4"}},[r._v("Abril")]),r._v(" "),c("option",{attrs:{value:"5"}},[r._v("Mayo")]),r._v(" "),c("option",{attrs:{value:"6"}},[r._v("Junio")]),r._v(" "),c("option",{attrs:{value:"7"}},[r._v("Julio")]),r._v(" "),c("option",{attrs:{value:"8"}},[r._v("Agosto")]),r._v(" "),c("option",{attrs:{value:"9"}},[r._v("Septiembre")]),r._v(" "),c("option",{attrs:{value:"10"}},[r._v("Octubre")]),r._v(" "),c("option",{attrs:{value:"11"}},[r._v("Noviembre")]),r._v(" "),c("option",{attrs:{value:"12"}},[r._v("Diciembre")])])]),r._v(" "),c("div",{staticClass:"form-group"},[c("label",{attrs:{for:"year"}},[r._v("Año")]),r._v(" "),c("select",{directives:[{name:"model",rawName:"v-model",value:r.year,expression:"year"}],staticClass:"form-control",attrs:{id:"year"},on:{change:function(e){var t=Array.prototype.filter.call(e.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));r.year=e.target.multiple?t:t[0]}}},[c("option",{attrs:{value:"0"}},[r._v("Todos")]),r._v(" "),r._l(r.years,(function(e){return c("option",{key:e,domProps:{value:e}},[r._v(r._s(e))])}))],2)])])]),r._v(" "),c("div",{staticClass:"table-responsive"},[c("table",{staticClass:"table"},[c("thead",[c("tr",[c("th",[c("div",{staticClass:"form-check"},[c("input",{ref:"checkSelect",staticClass:"form-check-input",attrs:{type:"checkbox"},on:{change:r.selectAll}})])]),r._v(" "),c("th",{attrs:{scope:""}},[r._v("Factura")]),r._v(" "),c("th",{attrs:{scope:""}},[r._v("Cliente")]),r._v(" "),c("th",{attrs:{scope:""}},[r._v("Fecha")]),r._v(" "),c("th",{attrs:{scope:""}},[r._v("Acciones")])])]),r._v(" "),(null===(o=r.invoices)||void 0===o?void 0:o.length)>0?c("tbody",r._l(r.paginatedItems,(function(e){var t,n,o,l,v,d,f,m,_,h,w,y;return c("tr",{key:e.id},[c("td",[c("div",{staticClass:"form-check"},[c("input",{directives:[{name:"model",rawName:"v-model",value:r.selectedInvoices,expression:"selectedInvoices"}],staticClass:"form-check-input",attrs:{type:"checkbox"},domProps:{value:e.id,checked:Array.isArray(r.selectedInvoices)?r._i(r.selectedInvoices,e.id)>-1:r.selectedInvoices},on:{change:function(t){var n=r.selectedInvoices,o=t.target,c=!!o.checked;if(Array.isArray(n)){var l=e.id,v=r._i(n,l);o.checked?v<0&&(r.selectedInvoices=n.concat([l])):v>-1&&(r.selectedInvoices=n.slice(0,v).concat(n.slice(v+1)))}else r.selectedInvoices=c}}})])]),r._v(" "),c("td",[r._v(r._s(e.invoice_number))]),r._v(" "),c("td",[r._v(r._s("Guest"==(null===(t=e.order)||void 0===t||null===(n=t.user_profile)||void 0===n?void 0:n.name)?null===(o=e.order)||void 0===o||null===(l=o.guest)||void 0===l?void 0:l.name:null===(v=e.order)||void 0===v||null===(d=v.user_profile)||void 0===d?void 0:d.name)+" "+r._s("Guest"==(null===(f=e.order)||void 0===f||null===(m=f.user_profile)||void 0===m?void 0:m.lastname)?null===(_=e.order)||void 0===_||null===(h=_.guest)||void 0===h?void 0:h.lastname:null===(w=e.order)||void 0===w||null===(y=w.user_profile)||void 0===y?void 0:y.lastname))]),r._v(" "),c("td",[r._v(r._s(r.formatDate(e.created_at)))]),r._v(" "),c("td",[c("a",{staticClass:"btn bg-trivi-orange",on:{click:function(t){return t.preventDefault(),r.getUrl(e)}}},[c("i",{staticClass:"pe-7s-download"})])])])})),0):c("tbody",[r._m(1)])]),r._v(" "),c("div",{staticClass:"d-flex justify-content-center mt-2"},[c("pagination",{attrs:{records:r.invoices.length,perPage:parseInt(r.limit)},on:{paginate:r.myCallback},model:{value:r.page,callback:function(e){r.page=e},expression:"page"}})],1)])]),r._v(" "),r.pdfViewer?c("InvoiceViewer",{attrs:{id:r.id}}):r._e(),r._v(" "),r.newInvoice?c("NewInvoice"):r._e()],1)}),[function(){var e=this._self._c;return e("div",[e("h2",[this._v("Facturas")])])},function(){var e=this._self._c;return e("tr",[e("td",{attrs:{colspan:"6"}},[this._v("No hay pedidos pendientes.")])])}],!1,null,null,null);t.default=component.exports}}]);