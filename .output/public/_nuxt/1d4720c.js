(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{617:function(t,e,r){"use strict";r.r(e);r(17);var n=r(13),o=(r(15),r(0),r(31),r(12),r(2),r(55),{data:function(){return{products:[],reviews:[],page:1,perPage:10}},beforeMount:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getProducts();case 2:return e.next=4,t.getReviews();case 4:case"end":return e.stop()}}),e)})))()},computed:{paginatedReviews:function(){return this.reviews.slice((this.page-1)*this.perPage,this.page*this.perPage)}},methods:{getProducts:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch("getProducts",{page:"",category:"",search:"",slug:"",sort:"",tag:"",status:2});case 2:r=t.$store.getters.getProducts,t.products=r.data;case 4:case"end":return e.stop()}}),e)})))()},filterProduct:function(t){return this.products.filter((function(e){if(t==e.id)return e.name})).map((function(t){return t.name})).toString()},createReview:function(){var t=this,e=this.$refs.rating._data.selectedRating,form=this.$refs.newReview,r=new FormData(form);r.append("rating",e),r.append("user_id",this.$auth.user.id),r.append("user_profile_id",1),this.$axios.post("/api/reviews",r).then((function(e){form.reset(),t.$refs.rating._data.selectedRating=0,t.getReviews()})).catch((function(t){console.log(t)}))},getReviews:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$axios.get("/api/reviews").then((function(e){t.reviews=e.data.reviews}));case 2:case"end":return e.stop()}}),e)})))()},destroy:function(t){var e=this;return Object(n.a)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.$axios.delete("/api/reviews/"+t).then((function(t){e.getReviews()}));case 2:case"end":return r.stop()}}),r)})))()},myCallBack:function(t){this.page=t}}}),c=r(68),component=Object(c.a)(o,(function(){var t=this,e=t._self._c;return e("div",[e("div",{ref:"review-div",staticClass:"tab-pane",attrs:{id:"des-details3"}},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-lg-12"},[e("div",{staticClass:"ratting-form-wrapper"},[e("div",{staticClass:"ratting-form"},[e("h3",[t._v("Añadir una valoración")]),t._v(" "),e("form",{ref:"newReview",on:{submit:function(e){return e.preventDefault(),t.createReview.apply(null,arguments)}}},[e("div",[e("select",{staticClass:"form-select mt-2 mb-2",attrs:{id:"product-select",name:"product_id"}},[e("option",{attrs:{value:"default"}},[t._v("Seleccione un producto")]),t._v(" "),t._l(t.products,(function(r){return e("option",{key:r.id,domProps:{value:r.id}},[t._v(t._s(r.name))])}))],2)]),t._v(" "),e("div",{staticClass:"star-box"},[e("span",[t._v("Valoración:")]),t._v(" "),e("div",{staticClass:"ratting-star"},[e("vue-star-rating",{ref:"rating",attrs:{"star-size":20}})],1)]),t._v(" "),t._m(0)])])])])])]),t._v(" "),e("table",{staticClass:"table mt-5"},[t._m(1),t._v(" "),e("tbody",t._l(t.paginatedReviews,(function(r){return e("tr",{key:r.id},[e("td",[t._v(t._s(t.filterProduct(r.product_id)))]),t._v(" "),e("td",[t._v(t._s(r.user_name)+" "+t._s(r.user_lastname))]),t._v(" "),e("td",[e("vue-star-rating",{attrs:{"read-only":!0,rating:r.rating,"star-size":20}})],1),t._v(" "),e("td",[t._v(t._s(r.message))]),t._v(" "),e("td",[e("button",{on:{click:function(e){return e.preventDefault(),t.destroy(r.id)}}},[e("i",{staticClass:"fa fa-trash-o"})])])])})),0)]),t._v(" "),t.reviews.length>10?e("div",{staticClass:"d-flex justify-content-center"},[e("pagination",{attrs:{records:t.reviews.length,perPage:t.perPage},on:{paginate:t.myCallBack},model:{value:t.page,callback:function(e){t.page=e},expression:"page"}})],1):t._e()])}),[function(){var t=this,e=t._self._c;return e("div",{staticClass:"row"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-6"},[e("div",{staticClass:"rating-form-style mb-10"},[e("input",{attrs:{name:"user_name",placeholder:"Nombre",type:"text",required:""}})])]),t._v(" "),e("div",{staticClass:"col-md-6"},[e("div",{staticClass:"rating-form-style mb-10"},[e("input",{attrs:{name:"user_lastname",placeholder:"Apellidos",type:"text",required:""}})])])]),t._v(" "),e("div",{staticClass:"col-md-12"},[e("div",{staticClass:"rating-form-style form-submit"},[e("textarea",{attrs:{name:"message",placeholder:"Escribe aquí tu valoración..."}}),t._v(" "),e("button",{staticClass:"btn btn-light",attrs:{type:"submit",title:"Enviar"}},[t._v("Crear")])])])])},function(){var t=this,e=t._self._c;return e("thead",[e("tr",[e("th",{attrs:{scope:"col"}},[t._v("Producto")]),t._v(" "),e("th",{attrs:{scope:"col"}},[t._v("Usuario")]),t._v(" "),e("th",{attrs:{scope:"col"}},[t._v("Valoración")]),t._v(" "),e("th",{attrs:{scope:"col"}},[t._v("Comentario")]),t._v(" "),e("th",{attrs:{scope:"col"}},[t._v("Acciones")])])])}],!1,null,null,null);e.default=component.exports}}]);