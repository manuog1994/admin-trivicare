(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{541:function(t,e){t.exports=function(data,t,e,o){var r=new Blob(void 0!==o?[o,data]:[data],{type:e||"application/octet-stream"});if(void 0!==window.navigator.msSaveBlob)window.navigator.msSaveBlob(r,t);else{var n=window.URL&&window.URL.createObjectURL?window.URL.createObjectURL(r):window.webkitURL.createObjectURL(r),d=document.createElement("a");d.style.display="none",d.href=n,d.setAttribute("download",t),void 0===d.download&&d.setAttribute("target","_blank"),document.body.appendChild(d),d.click(),setTimeout((function(){document.body.removeChild(d),window.URL.revokeObjectURL(n)}),200)}}},551:function(t,e,o){t.exports={}},561:function(t,e,o){"use strict";o(551)},591:function(t,e,o){"use strict";o.r(e);o(17),o(133);var r=o(11),n=(o(51),o(0),o(18),o(19),o(13),{components:{ModalTrack:function(){return o.e(17).then(o.bind(null,646))}},data:function(){return{order:{},products:[],id:this.$route.params.id,users:[],user:{},status:""}},mounted:function(){this.getOrder()},methods:{getOrder:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$axios.get("/api/orders?filter[id]="+t.id).then((function(e){e.data.data.map((function(e){e.id==t.id&&(t.order=e,t.products=JSON.parse(e.products))}))})).catch((function(t){}));case 2:case"end":return e.stop()}}),e)})))()},discountedPrice:function(t){return t.price_base-t.price_base*t.discount/100},getState:function(t){return 1==t.status?"Recibido":2==t.status?"Preparando":3==t.status?"Enviado":4==t.status?"Entregado":"Cancelado"},getPaymentState:function(t){return"PENDIENTE"==t.paid?"Pendiente":"PROCESANDO"==t.paid?"Procesando":"PAGADO"==t.paid?"Pagado":"RECHAZADO"==t.paid?"Rechazado":"CONTRAREEMBOLSO"==t.paid?"Contra reembolso":"TRANSFERENCIA"==t.paid?"Transferencia":void 0},getUrl:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=o(541),r.next=3,e.$axios.get("/api/invoices/"+t.invoice.id,{responseType:"blob"}).then((function(e){n(e.data,t.invoice.filename)}));case 3:case"end":return r.stop()}}),r)})))()},updateStatus:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(3!=(o=t.$refs.formStatus.status.value)){e.next=6;break}t.$modal.hide("update-state"),t.$modal.show("modal-track",t.order.id),e.next=8;break;case 6:return e.next=8,t.$axios.put("/api/orders/status/"+t.order.id,{status:o}).then((function(){return window.location.reload()}));case 8:case"end":return e.stop()}}),e)})))()},updatePaid:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.$refs.formPaid.paid.value,e.next=3,t.$axios.put("/api/orders/paid/"+t.order.id,{paid:o}).then((function(){return window.location.reload()}));case 3:case"end":return e.stop()}}),e)})))()}}}),d=(o(561),o(68)),component=Object(d.a)(n,(function(){var t,e,o,r,n,d,v,l,c,_,f,m,h,C,w,x,y,R,P,k,E,S,O,j,N,D,F,$,A,T,U,L,G=this,z=G._self._c;return z("div",{staticClass:"container pt-3 pb-100"},[G._m(0),G._v(" "),z("div",[z("div",{staticClass:"row"},[z("div",{staticClass:"col-lg-4 mb-4"},[z("h4",[G._v("Datos del pedido")]),G._v(" "),z("p",[G._v("Id pedido: "),z("strong",[G._v(G._s(G.order.id))])]),G._v(" "),null!==(t=G.order)&&void 0!==t&&null!==(e=t.invoice)&&void 0!==e&&e.invoice_number?z("p",[G._v("Nº Factura: "),z("strong",[G._v(G._s(null===(o=G.order)||void 0===o||null===(r=o.invoice)||void 0===r?void 0:r.invoice_number))])]):G._e(),G._v(" "),z("p",[G._v("Fecha: "),z("strong",[G._v(G._s(G.order.order_date))])]),G._v(" "),z("p",[G._v("Estado: "),z("strong",[G._v(G._s(G.getState(G.order)))])]),G._v(" "),z("p",[G._v("Estado de pago: "),z("strong",[G._v(G._s(G.getPaymentState(G.order)))])]),G._v(" "),z("p",[G._v("Método de pago: "),z("strong",[G._v(G._s(G.order.payment_method))])]),G._v(" "),z("p",[G._v("Método de envío: "),z("strong",[G._v(G._s(G.order.shipping_method))])]),G._v(" "),"pickup-point"==(null===(n=G.order)||void 0===n?void 0:n.shipping_method)&&null!=G.order.pickup_point?z("p",[G._v("Punto de recogida: "),z("strong",[G._v(G._s(G.order.pickup_point))])]):G._e()]),G._v(" "),z("div",{staticClass:"col-lg-4 mb-4"},[z("h4",[G._v("Datos del cliente")]),G._v(" "),z("p",[G._v("Nombre: "),z("strong",[G._v(G._s("Guest"==(null===(d=G.order.user_profile)||void 0===d?void 0:d.name)?null===(v=G.order.guest)||void 0===v?void 0:v.name:null===(l=G.order.user_profile)||void 0===l?void 0:l.name)+" "+G._s("Guest"==(null===(c=G.order.user_profile)||void 0===c?void 0:c.lastname)?null===(_=G.order.guest)||void 0===_?void 0:_.lastname:null===(f=G.order.user_profile)||void 0===f?void 0:f.lastname))])]),G._v(" "),z("p",[G._v("Correo: "),z("strong",[G._v(G._s("guest@guest.com"==(null===(m=G.order.user)||void 0===m?void 0:m.email)?null===(h=G.order.guest)||void 0===h?void 0:h.email:null===(C=G.order.user)||void 0===C?void 0:C.email))])]),G._v(" "),z("p",[G._v("Teléfono: "),z("strong",[G._v(G._s(0==(null===(w=G.order.user_profile)||void 0===w?void 0:w.phone)?null===(x=G.order.guest)||void 0===x?void 0:x.phone:null===(y=G.order.user_profile)||void 0===y?void 0:y.phone))])]),G._v(" "),z("p",[G._v("DNI/NIE/NIF: "),z("strong",[G._v(G._s("00000000A"==(null===(R=G.order.user_profile)||void 0===R?void 0:R.dni)?null===(P=G.order.guest)||void 0===P?void 0:P.dni:null===(k=G.order.user_profile)||void 0===k?void 0:k.dni))])])]),G._v(" "),z("div",{staticClass:"col-lg-4 mb-4"},[z("h4",[G._v("Datos de envío")]),G._v(" "),z("p",[G._v("Dirección: "),z("strong",[G._v(G._s("Guest"==(null===(E=G.order.user_profile)||void 0===E?void 0:E.address)?null===(S=G.order.guest)||void 0===S?void 0:S.address:null===(O=G.order.user_profile)||void 0===O?void 0:O.address))])]),G._v(" "),z("p",[G._v("Ciudad: "),z("strong",[G._v(G._s("Guest"==(null===(j=G.order.user_profile)||void 0===j?void 0:j.city)?null===(N=G.order.guest)||void 0===N?void 0:N.city:null===(D=G.order.user_profile)||void 0===D?void 0:D.city))])]),G._v(" "),z("p",[G._v("Provincia: "),z("strong",[G._v(G._s("Guest"==(null===(F=G.order.user_profile)||void 0===F?void 0:F.state)?null===($=G.order.guest)||void 0===$?void 0:$.state:null===(A=G.order.user_profile)||void 0===A?void 0:A.state))])]),G._v(" "),z("p",[G._v("Código postal: "),z("strong",[G._v(G._s(0==(null===(T=G.order.user_profile)||void 0===T?void 0:T.zipcode)?null===(U=G.order.guest)||void 0===U?void 0:U.zipcode:null===(L=G.order.user_profile)||void 0===L?void 0:L.zipcode))])])])])]),G._v(" "),z("div",[z("table",{staticClass:"table"},[G._m(1),G._v(" "),z("tbody",G._l(this.products,(function(t){return z("tr",{key:t.id},[z("td",[z("strong",[G._v(G._s(t.name))])]),G._v(" "),z("td",[G._v(G._s(t.cartQuantity))]),G._v(" "),z("td",[t.discount<0?z("span",[G._v("\n                            "+G._s((1.21*t.price_base).toFixed(2))+" €\n                        ")]):z("span",[G._v("\n                            "+G._s((1.21*G.discountedPrice(t)).toFixed(2))+" €\n                        ")])]),G._v(" "),z("td",[G._v(G._s((t.price_base*t.cartQuantity*1.21).toFixed(2))+" €")])])})),0)])]),G._v(" "),z("div",[z("div",{staticClass:"d-flex justify-content-start"},[z("div",{staticClass:"mt-2"},[z("h4",[G._v("Nota del pedido: "),z("strong",[G._v(G._s(G.order.note))])]),G._v(" "),z("h4",{staticClass:"mt-2"},[G._v("Factura en papel: "),z("strong",[G._v(G._s(1==G.order.invoice_paper?"Si":"No"))])])])]),G._v(" "),z("div",{staticClass:"d-flex justify-content-end mt-4"},[z("div",{staticClass:"d-flex flex-column"},[z("div",{staticClass:"d-flex justify-content-between mb-2"},[z("div",{staticClass:"me-2 fw-bold"},[G._v("Subtotal:")]),G._v(" "),z("div",[G._v(G._s((1.21*G.order.total).toFixed(2))+" €")])]),G._v(" "),G.order.coupon?z("div",{staticClass:"d-flex justify-content-between mb-2"},[z("div",{staticClass:"me-2 fw-bold"},[G._v("Cupón:")]),G._v(" "),z("div",[G._v(G._s(G.order.coupon)+" ")])]):G._e(),G._v(" "),z("div",{staticClass:"d-flex justify-content-evenly mb-2"},[G._m(2),G._v(" "),0==G.order.shipping?z("div",[z("p",{staticClass:"text-danger ms-4"},[G._v("Gratis")])]):z("div",[z("p",{staticClass:"text-danger ms-4"},[G._v(G._s(G.order.shipping)+" €")])])]),G._v(" "),z("div",{staticClass:"d-flex justify-content-between mt-2"},[z("div",{staticClass:"me-2 fs-4 fw-bold"},[G._v("Total:")]),G._v(" "),0==G.order.shipping?z("div",{staticStyle:{"font-size":"20px"}},[G._v(G._s((1.21*G.order.total).toFixed(2))+" €")]):z("div",{staticStyle:{"font-size":"20px"}},[G._v(G._s((1.21*parseFloat(G.order.total)+parseFloat(G.order.shipping)).toFixed(2))+" €")])])])])]),G._v(" "),z("div",{staticClass:"d-flex justify-content-around mt-5 fixed-bottom bg-trivi-purple p-4"},[z("button",{staticClass:"btn bg-trivi-blue text-white",on:{click:function(t){return G.$modal.show("update-state",G.order)}}},[z("i",{staticClass:"fa fa-truck icon-nav-order"})]),G._v(" "),z("button",{staticClass:"btn bg-trivi-orange text-white",on:{click:function(t){return G.$modal.show("update-pay",G.order)}}},[z("i",{staticClass:"fa fa-credit-card icon-nav-order"})]),G._v(" "),z("button",{staticClass:"btn bg-trivi-green text-white",class:{disabled:!G.order.email_sent},on:{click:function(t){return t.preventDefault(),G.getUrl(G.order)}}},[z("i",{staticClass:"fa fa-download icon-nav-order"})]),G._v(" "),z("button",{staticClass:"btn bg-trivi-red text-white",on:{click:function(t){return G.$router.push({path:"/orders"})}}},[z("i",{staticClass:"fa fa-level-up icon-nav-order"})])]),G._v(" "),z("modal",{attrs:{name:"update-state",width:"800px",height:"auto"}},[z("div",{staticClass:"p-5"},[z("div",[z("h2",[G._v("Cambiar estado del pedido")])]),G._v(" "),z("form",{ref:"formStatus",on:{submit:function(t){return t.preventDefault(),G.updateStatus.apply(null,arguments)}}},[z("div",[z("label",{attrs:{for:"status"}},[G._v("Estado")]),G._v(" "),z("select",{staticClass:"form-select",attrs:{name:"status",id:"status"},domProps:{value:G.order.status}},[z("option",{attrs:{value:"1"}},[G._v("Recibido")]),G._v(" "),z("option",{attrs:{value:"2"}},[G._v("Preparando")]),G._v(" "),z("option",{attrs:{value:"3"}},[G._v("Enviado")]),G._v(" "),z("option",{attrs:{value:"4"}},[G._v("Entregado")]),G._v(" "),z("option",{attrs:{value:"4"}},[G._v("Cancelado")])])]),G._v(" "),z("div",{staticClass:"d-flex justify-content-end mt-3"},[z("button",{staticClass:"btn btn-primary",attrs:{type:"submit"}},[G._v("Enviar")])])])])]),G._v(" "),z("ModalTrack"),G._v(" "),z("modal",{attrs:{name:"update-pay",width:"800px",height:"auto"}},[z("div",{staticClass:"p-5"},[z("div",[z("h2",[G._v("Cambiar estado de pago")])]),G._v(" "),z("form",{ref:"formPaid",on:{submit:function(t){return t.preventDefault(),G.updatePaid.apply(null,arguments)}}},[z("div",[z("label",{attrs:{for:"pay"}},[G._v("Estado")]),G._v(" "),z("select",{staticClass:"form-select",attrs:{name:"paid",id:"paid"},domProps:{value:G.order.paid}},[z("option",{attrs:{value:"Selecciona un estado",disabled:"",selected:""}},[G._v("Seleccione un estado")]),G._v(" "),z("option",{attrs:{value:"1"}},[G._v("Pendiente")]),G._v(" "),z("option",{attrs:{value:"2"}},[G._v("Procesando")]),G._v(" "),z("option",{attrs:{value:"3"}},[G._v("Pagado")]),G._v(" "),z("option",{attrs:{value:"4"}},[G._v("Rechazado")])])]),G._v(" "),z("div",{staticClass:"d-flex justify-content-end mt-3"},[z("button",{staticClass:"btn btn-primary",attrs:{type:"submit"}},[G._v("Enviar")])])])])])],1)}),[function(){var t=this._self._c;return t("div",{staticClass:"mb-5"},[t("div",[t("h2",[this._v("Detalle del pedido")])])])},function(){var t=this,e=t._self._c;return e("thead",[e("tr",[e("th",{attrs:{scope:"col"}},[t._v("Producto")]),t._v(" "),e("th",{attrs:{scope:"col"}},[t._v("Cantidad")]),t._v(" "),e("th",{attrs:{scope:"col"}},[t._v("Precio")]),t._v(" "),e("th",{attrs:{scope:"col"}},[t._v("Total")])])])},function(){var t=this._self._c;return t("div",{staticClass:"me-2"},[t("p",{staticClass:"fw-bold"},[this._v("Gastos de envío:")])])}],!1,null,null,null);e.default=component.exports}}]);