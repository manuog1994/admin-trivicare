(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{572:function(t,e,n){t.exports={}},592:function(t,e,n){"use strict";n(572)},619:function(t,e,n){"use strict";n.r(e);n(17),n(133),n(5),n(4),n(6),n(3),n(7);var r=n(24),o=n(13),c=(n(55),n(0),n(18),n(19),n(80),n(2),n(566)),l=n(567);function d(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function v(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?d(Object(source),!0).forEach((function(e){Object(r.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):d(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var f={data:function(){return{paises:[{id:28,name:"España"}],ciudades:l,provincias:c,cities:[],cart:[],products:[],total:0,discount:0,total_discount:0}},components:{SuccessInvoiceModal:function(){return n.e(14).then(n.bind(null,623))},ErrorModal:function(){return n.e(8).then(n.bind(null,616))}},mounted:function(){this.getProducts()},methods:{getStates:function(t){var e=t.target.value,n=this.paises.find((function(t){return t.name===e})).id;this.provincias=this.provincias.data.filter((function(t){return t.id_country===n}))},getCities:function(t){var e=t.target.value,n=this.provincias.find((function(t){return t.name===e})).id;this.cities=this.ciudades.data.filter((function(t){return t.id_state===n}))},getProducts:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch("getProducts",{page:"",category:"",search:"",slug:"",sort:"",tag:"",status:""});case 2:n=t.$store.getters.getProducts,t.products=n.data;case 4:case"end":return e.stop()}}),e)})))()},addToCart:function(t){var e=t.target.value,n=this.products.find((function(t){return t.id==e}));if(this.cart.find((function(t){return t.id==n.id}))){var r=this.cart.find((function(t){return t.id==n.id})).cartQuantity++;this.cart.find((function(t){return t.id==n.id})).total=n.price_base*(r+1),this.getTotal()}else this.cart.push(v(v({},n),{},{cartQuantity:1,total:1*n.price_base})),this.getTotal()},incrementProduct:function(t){this.cart.find((function(e){return e.id===t.id})).cartQuantity++,this.cart.find((function(e){return e.id===t.id})).total=t.price_base*t.cartQuantity,this.getTotal()},decrementProduct:function(t){this.cart.find((function(e){return e.id===t.id})).cartQuantity--,this.cart.find((function(e){return e.id===t.id})).total=t.price_base*t.cartQuantity,this.getTotal()},getTotal:function(){this.total=this.cart.reduce((function(t,e){return t+e.total}),0)},removeProduct:function(t){this.cart=this.cart.filter((function(e){return e.id!=t})),this.getTotal()},applyDiscount:function(){this.total_discount=(this.total*this.discount/100).toFixed(2)},createInvoice:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var form,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return form=t.$refs.createinvoice,(data=new FormData(form)).append("total",t.total),data.append("subTotal",t.total),data.append("discount",t.discount),data.append("products",JSON.stringify(t.cart)),e.next=8,t.$axios.post("/api/new-invoice",data).then((function(e){var n=e.data;t.$refs.createinvoice.reset(),t.cart=[],t.total=0,t.discount=0,t.total_discount=0,t.$modal.show("successInvoice",n)})).catch((function(e){t.$modal.show("errorModal",e.response.data)}));case 8:case"end":return e.stop()}}),e)})))()}}},m=(n(592),n(68)),component=Object(m.a)(f,(function(){var t=this,e=t._self._c;return e("div",[t._m(0),t._v(" "),e("div",[e("form",{ref:"createinvoice",on:{submit:function(e){return e.preventDefault(),t.createInvoice.apply(null,arguments)}}},[e("div",{staticClass:"row"},[t._m(1),t._v(" "),t._m(2),t._v(" "),t._m(3),t._v(" "),t._m(4),t._v(" "),t._m(5),t._v(" "),e("div",{staticClass:"col-lg-6 col-md-6 mb-2"},[e("label",{attrs:{for:""}},[t._v("País")]),t._v(" "),e("select",{staticClass:"form-select",attrs:{"aria-label":"Default select example",name:"country",required:""},on:{change:t.getStates}},[e("option",{attrs:{disabled:"",selected:""}},[t._v("Seleccione su país")]),t._v(" "),t._l(t.paises,(function(n){return e("option",{key:n.id,domProps:{value:n.name}},[t._v(t._s(n.name))])}))],2)]),t._v(" "),e("div",{staticClass:"col-lg-6 col-md-6 mb-2"},[e("label",{attrs:{for:""}},[t._v("Provincia")]),t._v(" "),e("select",{staticClass:"form-select",attrs:{"aria-label":"Default select example",name:"state",required:""},on:{change:t.getCities}},[e("option",{attrs:{disabled:"",selected:""}},[t._v("Seleccione su provincia")]),t._v(" "),t._l(t.provincias,(function(n){return e("option",{key:"state"+n.id,domProps:{value:n.name}},[t._v(t._s(n.name))])}))],2)]),t._v(" "),e("div",{staticClass:"col-12 col-md-6 mb-2"},[e("label",{attrs:{for:""}},[t._v("Ciudad")]),t._v(" "),e("select",{staticClass:"form-select",attrs:{"aria-label":"Default select example",name:"city",required:""}},[e("option",{attrs:{disabled:"",selected:""}},[t._v("Seleccione su ciudad")]),t._v(" "),t._l(t.cities,(function(n){return e("option",{key:"city"+n.name,domProps:{value:n.name}},[t._v(t._s(n.name))])}))],2)]),t._v(" "),t._m(6),t._v(" "),t._m(7),t._v(" "),t._m(8),t._v(" "),e("div",[e("select",{staticClass:"form-select",on:{change:t.addToCart}},[e("option",{attrs:{disabled:"",selected:""}},[t._v("Seleccione un producto")]),t._v(" "),t._l(t.products,(function(n){return e("option",{key:n.id,domProps:{value:n.id}},[t._v(t._s(n.name))])}))],2)]),t._v(" "),e("div",{staticClass:"mt-3 border-bottom-1"},[e("p",[t._v("Productos agregados")]),t._v(" "),t._l(t.cart,(function(n){return e("div",{key:n.id,staticClass:"row d-flex align-items-center mb-2"},[e("div",{staticClass:"col-6"},[e("p",[e("strong",[t._v(t._s(n.name))])]),t._v(" "),e("p",[t._v(t._s((1.21*n.total).toFixed(2))+" €")])]),t._v(" "),e("div",{staticClass:"col-4"},[e("div",{staticClass:"d-flex justify-content-center"},[e("button",{staticClass:"button-quantity",attrs:{title:"Quitar"},on:{click:function(e){return e.preventDefault(),t.decrementProduct(n)}}},[t._v("-")]),t._v(" "),e("input",{staticClass:"box-quantity",attrs:{type:"text",readonly:""},domProps:{value:n.cartQuantity}}),t._v(" "),e("button",{staticClass:"button-quantity",attrs:{title:"Añadir"},on:{click:function(e){return e.preventDefault(),t.incrementProduct(n)}}},[t._v("+")])])]),t._v(" "),e("div",{staticClass:"col-2",staticStyle:{"text-align":"right"}},[e("p",[e("strong",[e("a",{attrs:{title:n.id},on:{click:function(e){return t.removeProduct(n.id)}}},[t._v("x")])])])])])}))],2),t._v(" "),e("div",[e("p",[t._v("\n                        Total:\n                        "),e("strong",[t._v(t._s((1.21*(t.total-t.total_discount)).toFixed(2))+" €")])])]),t._v(" "),e("div",{staticClass:"mt-5"},[e("label",{attrs:{for:"discount"}},[t._v("Descuento")]),t._v(" "),e("div",{staticClass:"d-flex"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.discount,expression:"discount"}],staticClass:"form-control",attrs:{type:"number",placeholder:"Introduce el descuento"},domProps:{value:t.discount},on:{input:function(e){e.target.composing||(t.discount=e.target.value)}}}),t._v(" "),e("button",{staticClass:"ms-1 btn btn-primary",on:{click:function(e){return e.preventDefault(),t.applyDiscount.apply(null,arguments)}}},[t._v("Aplicar")])])]),t._v(" "),t._m(9)])])]),t._v(" "),e("SuccessInvoiceModal"),t._v(" "),e("ErrorModal")],1)}),[function(){var t=this._self._c;return t("div",[t("h4",[this._v("Generar factura")])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"col-12 col-md-6 mb-2"},[e("label",{attrs:{for:"name"}},[t._v("Nombre")]),t._v(" "),e("input",{staticClass:"form-control",attrs:{type:"text",name:"name",id:"name"}})])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"col-12 col-md-6 mb-2"},[e("label",{attrs:{for:"lastname"}},[t._v("Apellidos")]),t._v(" "),e("input",{staticClass:"form-control",attrs:{type:"text",name:"lastname",id:"lastname"}})])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"col-12 col-md-6 mb-2"},[e("label",{attrs:{for:"email"}},[t._v("Email")]),t._v(" "),e("input",{staticClass:"form-control",attrs:{type:"email",name:"email",id:"email"}})])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"col-12 col-md-6 mb-2"},[e("label",{attrs:{for:"phone"}},[t._v("Teléfono")]),t._v(" "),e("input",{staticClass:"form-control",attrs:{type:"number",name:"phone",id:"phone"}})])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"col-12 mb-2"},[e("label",{attrs:{for:"address"}},[t._v("Dirección")]),t._v(" "),e("input",{staticClass:"form-control",attrs:{type:"text",name:"address",id:"address"}})])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"col-12 col-md-6 mb-2"},[e("label",{attrs:{for:"zipcode"}},[t._v("Código Postal")]),t._v(" "),e("input",{staticClass:"form-control",attrs:{type:"number",name:"zipcode",id:"zipcode"}})])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"col-12 col-md-6 mb-2"},[e("label",{attrs:{for:"dni"}},[t._v("DNI")]),t._v(" "),e("input",{staticClass:"form-control",attrs:{type:"text",name:"dni",id:"dni"}})])},function(){var t=this._self._c;return t("div",{staticClass:"mt-3"},[t("p",[this._v("Productos")])])},function(){var t=this._self._c;return t("div",{staticClass:"mt-5 d-flex justify-content-center"},[t("button",{staticClass:"btn btn-theme",attrs:{type:"submit"}},[this._v("Crear Factura")])])}],!1,null,null,null);e.default=component.exports}}]);